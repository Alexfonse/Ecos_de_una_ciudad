<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Slider con Efecto Pintura (Clic)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Define la fuente Inter para todo el cuerpo del documento */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f2f5; /* Un fondo suave y claro */
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh; /* Asegura que el cuerpo ocupe al menos toda la altura de la ventana */
            margin: 0;
            padding: 20px; /* Padding general para el contenido */
            box-sizing: border-box; /* Incluye padding y borde en el tamaño total del elemento */
        }
        /* Estilos específicos para las imágenes dentro del contenedor para asegurar que cubran el área */
        .image-cover {
            object-fit: cover; /* La imagen cubrirá el área, recortándose si es necesario */
            width: 100%;
            height: 100%;
        }

        /* Oculta el SVG de la máscara para que no ocupe espacio visual en el diseño */
        .hidden-svg-mask {
            position: absolute;
            width: 0;
            height: 0;
            overflow: hidden; /* Asegura que no se muestre nada fuera de sus dimensiones cero */
        }

        /* Estilos para el indicador visual de clic */
        .click-indicator {
            position: absolute;
            background-color: #a78bfa; /* Un color púrpura suave que combina con la estética */
            border-radius: 50%; /* Lo convierte en un círculo */
            opacity: 0; /* Inicialmente invisible */
            width: 20px;
            height: 20px;
            /* Centra el indicador perfectamente en el punto de clic */
            transform: translate(-50%, -50%) scale(1);
            /* Transiciones suaves para la aparición y desaparición */
            transition: opacity 0.3s ease-out, transform 0.3s ease-out;
            pointer-events: none; /* Asegura que el indicador no interfiera con los clics */
            z-index: 10; /* Lo coloca por encima de las imágenes */
        }
    </style>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen">

    <div class="relative w-full max-w-2xl mx-auto overflow-hidden rounded-2xl shadow-xl bg-white p-6 md:p-8 cursor-pointer">
        <h1 class="text-3xl md:text-4xl font-bold text-center mb-6 text-gray-800">
            Mi Galería de Arte Digital
        </h1>
        <div id="imageContainer" class="relative w-full aspect-video rounded-xl overflow-hidden mb-8">
            <img id="currentImage" src="https://placehold.co/1200x675/0000FF/FFFFFF?text=Paisaje+Azul"
                alt="Imagen actual" class="absolute inset-0 image-cover rounded-xl">
            <img id="nextImage" src="https://placehold.co/1200x675/FF0000/FFFFFF?text=Rojo+Abstracto"
                alt="Siguiente imagen" class="absolute inset-0 image-cover rounded-xl opacity-0">
            </div>

        <p class="text-center text-gray-600 text-lg">Haz clic en la imagen para cambiarla</p>
    </div>

    <svg class="hidden-svg-mask">
        <defs>
            <filter id="displacementFilter">
                <feTurbulence type="fractalNoise" baseFrequency="0.03" numOctaves="3" result="noise" />
                <feDisplacementMap in="SourceGraphic" in2="noise" scale="30" xChannelSelector="R" yChannelSelector="G" />
            </filter>
            <mask id="paintMask">
                <circle cx="0" cy="0" r="0" fill="white" id="maskCircle" filter="url(#displacementFilter)" />
            </mask>
        </defs>
    </svg>

    <script>
        // Array de URLs de imágenes para el slider
        const images = [
            "https://placehold.co/1200x675/0000FF/FFFFFF?text=Paisaje+Azul",
            "https://placehold.co/1200x675/FF0000/FFFFFF?text=Rojo+Abstracto",
            "https://placehold.co/1200x675/00FF00/FFFFFF?text=Verde+Naturaleza",
            "https://placehold.co/1200x675/FFFF00/000000?text=Amarillo+Sol",
            "https://placehold.co/1200x675/FF00FF/FFFFFF?text=Magenta+Creativo"
        ];

        let currentIndex = 0; // Índice de la imagen actual
        let transitioning = false; // Bandera para evitar transiciones múltiples al mismo tiempo

        // Obtener referencias a los elementos del DOM
        const imageContainer = document.getElementById('imageContainer');
        const currentImage = document.getElementById('currentImage');
        const nextImage = document.getElementById('nextImage');
        const maskCircle = document.getElementById('maskCircle'); // Referencia al círculo dentro de la máscara SVG

        // Crear y añadir el elemento indicador de clic
        const clickIndicator = document.createElement('div');
        clickIndicator.className = 'click-indicator'; // Aplicar la clase CSS definida
        imageContainer.appendChild(clickIndicator); // Añadirlo al contenedor de la imagen

        // Inicializar el slider con la primera imagen
        currentImage.src = images[currentIndex];

        // Pre-cargar todas las imágenes para una experiencia más fluida
        images.forEach(imgUrl => {
            const img = new Image();
            img.src = imgUrl;
        });

        /**
         * Función para animar la transición de la máscara al hacer clic
         * @param {MouseEvent} event - El objeto de evento de clic
         */
        function animateMaskTransition(event) {
            // Si ya hay una transición en curso, salimos para evitar superposiciones
            if (transitioning) {
                console.log("Transición ya en curso, esperando...");
                return;
            }
            transitioning = true; // Establecemos la bandera de transición

            // Obtenemos las coordenadas del clic relativas al contenedor de la imagen
            const containerRect = imageContainer.getBoundingClientRect();
            const clickX = event.clientX - containerRect.left;
            const clickY = event.clientY - containerRect.top;

            // Actualizamos la posición del indicador de clic y lo mostramos
            clickIndicator.style.left = `${clickX}px`;
            clickIndicator.style.top = `${clickY}px`;
            clickIndicator.style.opacity = '0.8'; // Hacerlo visible
            clickIndicator.style.transform = 'translate(-50%, -50%) scale(1.5)'; // Crecimiento sutil

            // Programamos el desvanecimiento del indicador después de un corto tiempo
            setTimeout(() => {
                clickIndicator.style.opacity = '0';
                clickIndicator.style.transform = 'translate(-50%, -50%) scale(1)'; // Vuelve a su tamaño original
            }, 300); // 300 milisegundos

            // Calculamos el nuevo índice de la imagen (siempre la siguiente, con bucle)
            const newIndex = (currentIndex + 1) % images.length;

            // Establecemos la fuente de la siguiente imagen y la hacemos visible (pero enmascarada)
            nextImage.src = images[newIndex];
            nextImage.style.opacity = '1';
            // Aplicamos la máscara SVG a la siguiente imagen
            nextImage.style.mask = 'url(#paintMask)';
            nextImage.style.webkitMask = 'url(#paintMask)'; // Para compatibilidad con navegadores Webkit

            // Configuramos la posición inicial del círculo de la máscara (en el punto de clic) y su radio inicial (cero)
            // Convertimos las coordenadas de píxeles a porcentaje para que la máscara sea responsive
            maskCircle.setAttribute('cx', `${(clickX / containerRect.width) * 100}%`);
            maskCircle.setAttribute('cy', `${(clickY / containerRect.height) * 100}%`);
            maskCircle.setAttribute('r', '0'); // El círculo empieza con radio cero

            let startTime = null;
            const duration = 1500; // Duración de la animación en milisegundos (1.5 segundos)

            // Calculamos el radio máximo necesario para que el círculo cubra completamente la imagen desde el punto de clic
            const maxRadius = Math.sqrt(
                Math.max(clickX, containerRect.width - clickX)**2 + // Distancia horizontal máxima al borde
                Math.max(clickY, containerRect.height - clickY)**2  // Distancia vertical máxima al borde
            ) * 1.2; // Añadimos un buffer para asegurar una cobertura total

            /**
             * Función para el bucle de animación del círculo de la máscara
             * @param {DOMHighResTimeStamp} currentTime - Marca de tiempo actual proporcionada por requestAnimationFrame
             */
            function animate(currentTime) {
                if (!startTime) startTime = currentTime;
                const progress = (currentTime - startTime) / duration; // Progreso de la animación (de 0 a 1)

                if (progress < 1) {
                    // Animamos el radio del círculo de la máscara
                    // A medida que el progreso aumenta, el círculo crece y revela la siguiente imagen
                    maskCircle.setAttribute('r', `${progress * maxRadius}`);
                    requestAnimationFrame(animate); // Continuar la animación
                } else {
                    // La animación ha terminado
                    maskCircle.setAttribute('r', `${maxRadius}`); // Asegurarse de que esté completamente revelado

                    // Actualizamos la imagen actual con la que acaba de ser revelada
                    currentImage.src = nextImage.src;
                    currentImage.alt = nextImage.alt; // También actualizamos el texto alternativo

                    // Restablecemos la siguiente imagen y la máscara para la próxima transición
                    nextImage.style.opacity = '0'; // Ocultamos la siguiente imagen
                    nextImage.style.mask = 'none'; // Quitamos la máscara de la siguiente imagen
                    nextImage.style.webkitMask = 'none'; // Para compatibilidad con Webkit
                    maskCircle.setAttribute('r', '0'); // Restablecemos el radio del círculo para el siguiente uso

                    currentIndex = newIndex; // Actualizamos el índice de la imagen actual
                    transitioning = false; // Liberamos la bandera de transición
                }
            }

            requestAnimationFrame(animate); // Iniciamos la animación
        }

        // Añadir evento de clic al contenedor de la imagen para iniciar la transición
        imageContainer.addEventListener('click', animateMaskTransition);

        // Asegurarse de que la animación se inicie después de que la ventana haya cargado
        window.onload = function() {
            console.log("Página cargada. Slider listo para clics.");
        };
    </script>
</body>
</html>